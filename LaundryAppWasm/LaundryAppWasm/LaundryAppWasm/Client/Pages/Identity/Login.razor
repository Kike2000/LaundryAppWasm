@page "/login"
@using Microsoft.AspNetCore.Components.Forms
@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Components.Authorization
@inject HttpClient Http;
@inject NavigationManager _navigation

<h3>Login</h3>

<EditForm Model="userModel" OnValidSubmit="HandleLogin">
    <DataAnnotationsValidator />
    <div class="form-group">
        <label for="InputEmail">Email address</label>
        <InputText class="form-control" id="InputEmail" @bind-Value="userModel.Email" />
        <ValidationMessage For="() => userModel.Email" />
    </div>
    <div class="form-group">
        <label for="InputPassword">Password</label>
        <InputText type="password" id="ConfirmPassword" class="form-control" @bind-Value="userModel.Password" />
        <ValidationMessage For="() => userModel.Password" />
    </div>
    <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked" @bind="userModel.RememberMe">
        <label class="form-check-label" for="flexCheckChecked">
            Checked checkbox
        </label>
    </div>
    <button type="submit" class="btn btn-primary">Login</button>
</EditForm>
@code {
    public UserModel userModel = new();
    private async Task HandleLogin()
    {
        var response = await Http.PostAsJsonAsync("api/account/login", userModel);

        _navigation.NavigateTo("/");
    }

    public class UserModel
    {

        [Required(ErrorMessage = "Email is required.")]
        [EmailAddress(ErrorMessage = "Invalid email address.")]
        public string Email { get; set; }


        [Required(ErrorMessage = "Password is required.")]
        public string Password { get; set; }

        public bool RememberMe { get; set; }
    }
}

